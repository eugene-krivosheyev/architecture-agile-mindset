Принеси то, не знаю что
=======================
Существует ряд связанных фундаментальных инженерных проблем, три основных из которых мы тут обсуждаем.
Это
- [x] _Противоречивость требований_,
- [x] Внутренняя неопределенность – неопределенность _реализации_,
- [ ] Внешняя неопределенность – неопределенность _требований_.

Они сильно переплетаются между собой и первые две них мы рассмотрели.
Далее рассмотрим последнюю из них – _Неопределенность требований_.

Проблема _внешней_ неопределенности (требований)
-----------------------------------
Для некоторых it-компаний и подразделений абсолютно типовая ситуация, когда требования к системе неполны. То есть не хватает информации для обоснованного принятия архитектурных решений.
_Для примера представь_, что тебе нужно запроектировать табуретку, но

| проблема                     | в чем выражается                                                                                                                                                                                                                                                                                                                         |
|------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Неполны FR                   | Не до конца ясны функциональные требования: нет конечного понимания сценариев взаимодействия пользователя с системой, в каком окружении будет использоваться табуретка, зачем и с какой целью.                                                                                                                                           |
| Неполны NFR                  | Не до конца ясны нефункциональные требования: нет конечного понимания желаемых характеристик по прочности, весу, устойчивости.                                                                                                                                                                                                           |                                               
| Завтра требования поменяются | Мало того, что сейчас неясно, что ожидается от системы, так еще нет понимания, как система будет развиваться: это не позволит заложить необходимые элементы гибкости – точки изменения и расширения системы. То есть мы не предусмотрим съемный механизм защиты от падения, если это окажется детским стульчиком для малыша "на вырост". |

Важно, что эти проблемы могут прийти как по одной, так и сразу все.

_Что это значит конкретно для тебя?_
Проблема неопределенности требований выражается в двух факторах:
- *неполнота* (сегодня)
- *изменчивость* (неполнота завтра)

Мы не сможем делать успешные проекты и продукты без инструментов борьбы с этими рисками – когда не знаем, _что_ делать.

_Что дальше?_
Вспомни, как мы бороли внутреннюю неопределенность – неопределенность решения (когда точно не знаем, _как_ делать)?

Производственная система как ответ неопределенности
---------------------------------------------------
Как ты верно вспомнил, индустрия уже решала похожую задачу – борола внутреннюю неопределенность. Мы нашли ответы на вопрос _как_ делать, когда точно не уверены.
Но если пока на время отложить вопрос, что это были за приемы, стоит посмотреть на то, на каком уровне были эти решения. Это уровень не инженерии. То есть мы не можем решить проблемы на каком-то уровне абстракции, оставаясь на этом же уровне – нам надо подняться выше.

И если сгрести в кучу уже знакомые приемы борьбы с внутренней неопределенностью, ты увидишь, что это решения, принятые на уровне выше инженерного – на уровне _процесса_.
Процесс – это наши решения по поводу того, как мы строим нашу работу. В зависимости от контекста и того, какую первую книжку прочитал менеджер, уровень таких решений может называться _процесс_, _методология_, _управление проектами_, _управление рисками_, и тд.
Мы предлагаем для обозначения этого уровня решений термин *производственная система*. Он хорош тем, что охватывает почти весь спектр управленческих решений: и по тому, как строить поток работ, как строить команды, как управлять ресурсами и рисками и тд. 
В противовес, та система, которую мы порождаем, называется _целевой_. Получается, _производственная система_ порождает _целевую систему_.

Мы попозже обсудим подробнее, из каких решений состоит производственная система, и почему это нужно знать архитектору – разберем их влияние на архитектуру.
А пока нас интересует только часть решений – решения, направленные на борьбу с внешней неопределенностью.

_Что это значит конкретно для тебя?_
1. Действительно значимые инженерные проблемы редко решаются на инженерном уровне.
1. Человечество выстрадало целую огромную дисциплину – _менеджмент_, направленную на построение производственных систем.
1. Помимо других важнейших решений, при построении производственной системы мы решаем, _что делать с неопределенностью_? (внутренней и внешней)
1. Естественно, с опытом накапливаются типовые решения и приемы. Но если в проектировании они называются паттерны/шаблоны, то тут они называются _практики_.
1. Соответственно, носителю архитектурной функции нужно понимать практики борьбы с неопределенностью, уметь их реализовывать в работе и поддерживать своей архитектурой.   

_Что дальше?_
Вот теперь давай вернемся к конкретным практикам борьбы с _внутренней_ неопределенностью решения, которые ты вспомнил. Для _внешней_ неопределенности требований практики будут схожи.  

Справочник процессных практик борьбы с внешней неопределенностью
----------------------------------------------------------------
*Итак, что делать, когда непонятно, что делать?*

Дано: требования к табуретке неполны (сегодня) и изменчивы (завтра).

| Вариант действий                                            | Смысл действий                                                                               | Популярное название процесса/практики                                                                                                                                                                                                                                                                                                                               | Trade-off: чем расплатимся                                                                                                                                                                                                                                       | Поддерживающие практики                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|-------------------------------------------------------------|----------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Остановиться и дополнить требования от заказчика или рынка. | Не берем на себя риски неверного scope, перекладываем их с себя.                             | _Последовательный_ процесс. Нет ножек – нет мультиков, нет требований – нет целевой системы.                                                                                                                                                                                                                                                                        | Не всегда есть возможность дополнить scope у заказчика или рынка или стоимость такого полного scope требований непомерна.                                                                                                                                        | BDUF для проектирования. Если получаем полный scope требований, можем позволить себе запроектировать сразу все инженерные решения, чтобы потом два раза не вставать и не переделывать. Но не всегда: иногда даже для последовательного процесса применяется проектирование инкрементальное – даже когда весь scope требований ясен, проектируем, разрабатываем и поставляем инкрементально и с рефакторингом/переделками (это ситуации внешней определенности требований, но внутренней неопределенности реализации). |
| Дофантазировать все требования самим (командой разработки). | Берем на себя риски неверного scope.                                                         | _Последовательный_ процесс с взятием на себя функции Заказчика. (Часто проксируется ролью Менеджера Продукта).                                                                                                                                                                                                                                                      | Работает только при раскаченных персонажах со 100% удачи. В большинстве случаев даже очень квалифицированные Менеджеры Продуктов не могут гарантировать успех для _всего_ scope придуманных требований. В целом не рекомендуем, оценка 1 казиношная фишка из 10. | Практики из дисциплин Продуктового и Проектного Управления, чтобы хоть немного сделать рыночный фейл продукта не таким жестким.                                                                                                                                                                                                                                                                                                                                                                                       |
| Дофантазировать малую часть и быстро проверить. Повторить.  | Берем на себя небольшую часть рисков неверного scope, но настраиваем быструю обратную связь. | _Инкрементальный_ процесс. Не путай с итеративным – итерации могут быть и для проверки своей реализации, а не наших галлюцинаций по scope целевой системы. Инкремент отличается от итерации тем, что хотя тоже поставки частые, но вопрос в том, _что_ поставляется: инкремент поставляет *завершенный* кусочек scope для обратной связи – то/не то и что изменить. | Непрерывная трансформация целевой системы – через переделки нащупываем правильный scope, а переделки это дорого. Дорого переделывать, обеспечивать при этом качество и скорость поставок.                                                                        | Emergent Design для проектирования. Автотесты для частого регрессионного тестирования. DevOps-практики[@devops] для частых поставок. Принципы из Lean Software Development[@leanswd] для фокусировки решений. Time Boxing[@timeboxing] для поддержки ритма и фокуса.                                                                                                                                                                                                                                                  |

_Что это значит конкретно для тебя?_
1. Ты, как носитель архитектурной функции, _влияешь_ на процесс – зачастую тебе решать, как строить инженерные работы и бороть неопределенность.
1. Степень неопределенности требований задается сверху – из бизнес-контекста. Это на самом деле упрощает тебе задачу: нужно верно идентифицировать степень неопределенности и применить верную практику. То есть просто верно оценить ситуацию и не бузить против ветра. 
1. В таблице практик описаны крайности, в реальности внешняя неопределенность неравномерная – часть scope ясна и предсказуема лучше, чем другая. Поэтому управляй неопределенностью _адаптивно_: применяй подходящие практики для каждого фрагмента scope требований.

_Что дальше?_
Хорошо, нужно будет верно адаптировать процесс. Но это все менеджерское бла-бла-бла.
А вот на _инженерные_ решения, на архитектуру и код работа с неопределенностью хоть как-то влияет?

Как процессные практики влияют на инженерные решения
----------------------------------------------------
Итак, даны внешняя и внутренняя неопределенность. Носители архитектурной функции выбрали соответствующие процессные практики.
Влияют ли эти процессные практики на инженерные решения?

Еще как влияют на: выбор подходов к проектированию и вложения во внутреннее качество.

1. Выбор подходов к проектированию *DBUF/OCP vs Simple/Emergent Design/Code as a Configuration*. 
Когда требования полны на сегодня и предсказуемы на завтра, мы можем себе позволить:
- Запроектировать сразу всю целевую систему (Big Design UpFront), без циклов переделок. (При условии, что нет проблем с _внутренней_ неопределенностью – мы знаем, _как_ сделать все правильно). 
- Подстелить соломку и знать прикуп: заложить в архитектуру элементы изменяемости/расширяемости _в нужных местах_ (принцип OCP). То есть архитектуре появятся _обоснованные_ инкапсуляция ответственностей по модулям и интерфейсы.

Но если требования неполны на сегодня и меняются завтра, то придется проектировать по-другому:
- Делать проще (дешевле, быстрее, без заложенной гибкости и тем самым сложности): это Simple/Emergent Design. Но при этом мы сразу изначально закладываемся на то, что в перспективе все будет непрерывно меняться. Для этого есть еще одна хорошая метафора: раньше, когда предсказуемость была выше, мы разделяли в системе код и конфигурацию – в идеале код не меняется (клиенту даем только бинарники), а вся необходимая кастомизация делается через легко изменяемую конфигурацию (которая определяет границы гибкости и расширяемости). Так вот в современном подходе при высокой неопределенности мы не можем провести грань между стабильной частью системы (C в OCP) и подвижной открытой частью (O в OCP). Поэтому всю систему делаем (O)ткрытой – строим процесс и дизайн так, как будто весь код системы и есть подвижная конфигурация (Code as a Configuration). 

Вроде Simple/Emergent Design/CaaC выглядит легко: не думай, делай проще – не лепи сложность и гибкость, не перезакладывайся. Но для будущих легких изменений нужно, чтобы система обладала рядом свойств (внутренних характеристик NFR).

2. Вложения во внутреннее качество (внутр NFR)

Чтобы мы могли сегодня и завтра вносить любые изменения _в любую часть системы_, необходимо вложиться и постоянно обеспечивать:
- Понятность. Это стоимость локализации – нахождения места, куда внести изменение.
- Гибкость. Стоимость внесения самого изменения.
- Тестопригодность. Стоимость покрытия системы автотестами. Система может мешать писать тесты или помогать – это разница в стоимости каждого процента тестового покрытия.  
- Покрытие автотестами. Стоимость самих тестов до нужного нам уровня покрытия.
- Развертываемость. Стоимость раскатки системы на рабочие, тестовые и эксплуатационные среды. Привет DevOps-практикам.
- Наблюдаемость. Стоимость непрерывного снятия метрик, логов, трейсинга. 

_Что это значит конкретно для тебя?_
1. Как носителю архитектурной функции, тебе предстоит адаптировать систему под степень внешней неопределенности.
1. Хорошо, когда определенности больше – тогда ты сможешь запроектировать обоснованный дизайн и стандартными архитектурными приемами обеспечить гибкость и расширяемость.
1. Когда неопределенность требований высокая, то есть соблазн перезаложиться по гибкости и другим характеристикам NFR. Подстелить соломки везде и побольше. Но это очень рискованная стратегия – не обязательно, что гибкость будет востребована, а вот сложность раздует scope абсолютно точно и уже сегодня. К тому же, за избыточную гибкость придется расплатиться не только сложностью, но и другими характеристиками – производительностью, безопасностью, надежностью и тд. Получается "коробка" – очень гибкий комбайн с высокой стоимостью настройки, прожорливый и тормозной. 1 SAP из 10, не рекомендуем.      
1. Нужно уметь обеспечивать адаптивность за счет поддержки произвольных изменений в среде высокого внутреннего качества. Реализовать эти характеристики – архитектурная задача.    

_Что дальше?_
Мы увидим, как производственная система еще сильнее и непосредственно влияет на архитектуру.
