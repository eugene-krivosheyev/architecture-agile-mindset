Сказка о проекциях, слонах и гиперкубах
=======================================

PoV: как смотреть на систему
----------------------------
_Остановись на секунду_ и скажи свое мнение –
Какие _конкретно_ решения можно отнести к архитектурным? Как ты визуально представляешь архитектуру?

> Древняя история гласит: собрали как-то трех слепцов возле слона, которого они никогда не видели. И спросили: «Что такое слон?» 
> Один слепец начал хлопать слона по боку: «слон – это стена!» 
> Второй начал ощупывать ногу: «слон – это дерево!» 
> Третий схватился за хобот: «слон – это змея!»

Обычно люди представляют себе высокоуровневую диаграмму с квадратиками и стрелочками. Да, так можно представлять себе будущую систему, решая из каких элементов она состоит и как они связаны. Давай называть этот взгляд на систему _структурной декомпозицией_ – решение, «из чего состоит система». Вариантов распилить систему на составные части множество, поэтому необходимо принять решение, _как именно_ будем нарезать систему – какие составные части? сколько их? как будут связаны? Это важные решения, поэтому почти всегда можем их отнести к архитектурным решениям. 

Но только ли к нарезке системы на составные части сводятся ключевые решения? Ведь есть и другие важные решения: а в каком порядке будут взаимодействовать элементы? а как будем хранить данные? а как обеспечим лицензионную чистоту нашего ПО? а как будем выводить систему в эксплаутацию без простоя? а как представлять данные в нашем программном коде?

Все эти решения касаются разных аспектов системы, требуют разной экспертизы и участия разных людей. Получается, что сложность системы такова, что один человек не в состоянии представить её во всех аспектах и детялях. Необходимо разделить эту сложность по аспектам, отделить решения одного типа от другого. Такие множества решений называются _Point of View (PoV, точки зрения)_. Давай добавим новые слова в наш русско-инженерный разговорник:

| Термин             | Значение                                                                                                | Пример                                                                                              | Пример из табуреткостроения                                                                                                        |
|--------------------|---------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------|
| Целевая система    | То, над чем работаем                                                                                    | Клиентский web-портал                                                                               | Табуретка                                                                                                                          |
| Стейкхолдер        | Участник работ: человек или роль, которого хоть как-то касается целевая система                         | Заказчик, Спонсор, Пользователь, Юрист, Аналитик, Разработчик, QA, DevOps-инженер                   | Дизайнер, Проектировщцик, Столяр, Пользователь, Магазин мебели, Грузчик, Сборщик                                                   |
| Точка зрения (PoV) | Часть решений по целевой системе, отражающая интересы стейкхолдера и требующая отдельной экспертизы     | Структурная декомпозиция, Схема БД, Схема интеграции, Схема потоков данных                          | Набросок дизайна, Рассчет эпюры моментов сил, Спецификация материалов от материаловеда, Спецификация крепежа, Инструкция по сборке |
| Интерес (Concern)  | На что должны быть направлены архитектурные решения: зачем и как целевая система касается стейкхолдеров | Целевая система должна удовлетворять: Требования Пользователя, Бюджет Заказчика, Ограничения Юриста | Табуретка должна выдерживать Пользователя, быть бвстрособираемой для Сборщика, удобной для Грузчика                                |

Может показаться, что архитектура – это только для инженеров. Но как ты видишь сейчас, это не так – и архитектурная функция как раз является "точкой сборки" всех интересов: чтобы качественно принять самые главные решения по целевой системе, нужно как можно более полно понимать стейкхолдеров и их интересы.
И если учитывать всех стейкхолдеров и их многочисленные интересы, получается очень сложная картина. Что-то, что не влезает в голову. Например, как тессеракт (четырехмерный куб, гиперкуб) – фигура, которую мы принципиально не можем себе вообразить. 
Поэтому что мы делаем – мы проецируем его на трехмерное пространство, потом на двумерную плоскость (рисунок). И получив много таких рисунков-проекций, пытаемся хоть как-то понять его поведение.
Вот с целевой it-системой то же самое. Мы разбиваем все множество решений на группы и по этим точкам зрения – проекциям – пытаемся представить целевую систему.

Но значит ли это, что все точки зрения одинаково полезны и нужно заморачиваться _всеми_ этими решениями?
Отнюдь. В зависимости от проекта или продукта решения в рамках одной PoV могут оказаться крайне важными, а для другого проекта или продукта те же самые решения окажутся неважными. Такие решения, которые оказались не архитектурно-значимыми, можно просто отложить или дать на откуп разработчику, когда он дойдет до реализации.
Получается, что нужно осмысленно относиться к своим вложениям в проработку решений и не идти на поводу у прошлого опыта. Если в прошлом проекте схема БД была крайне важна, это не значит, что так же будет и в текущем проекте.

_Что это значит конкретно для тебя?_

1. Архитектурная функция – объединяющая, коммуникативная. Тебе нужно понимать ключевых стейкхолдеров и их интересы, чтобы успешно втащить ключевые решения по архитектуре.
1. Целевые системы сложны, поэтому мы разбиваем все ключевые решения на группы (точки зрения, PoV), чтобы справиться с этой сложностью.
1. Разные решения (PoV) требуют разной экспертизы – тебе нужно или обладать этой экспертизой, или четко знать, к кому обратиться по каждому классу решений.
1. Разные решения (PoV) обладают разной важностью – в каждом конкретном проекте или продукте нужно взвешивать, необходимо ли заморачиваться этим классом решений или отложить/делегировать.

_Что дальше?_
Вспомни, как ты ответил на вопрос «Как ты визуально представляешь архитектуру?» Почему?


Почему одна из PoV так важна?
-----------------------------
_Остановись на секунду_ и скажи свое мнение –
Что ты ответил на вопрос «Как ты визуально представляешь архитектуру?» Почему?

Скорее всего, образ архитектуры системы ты представил как рисунок с квадратиками и стрелочками. Это структурная декомпозиция. То есть решения «из чего состоит система?» Да, это важные решения, но почему мы интуитивно считаем их _самыми_ важными? Ведь эти решения не отвечают на многие вопросы – например, как хранятся данные или в каком порядке взаимодействуют элементы системы.

Нам кажется структурная декомпозиция настолько важной, потому что из неё непосредственно следует _план работ_ и _ресурсный план_ (Bill of Materials, BOM). То есть то, из чего состоит целевая система, определяет, как мы будем её реализовывать:

1. В каком порядке мы можем реализовать компоненты
1. Как мы можем распараллелить работы
1. Где мы работы распараллелить не сможем, тем самым определяя _критический путь_ проекта
1. Какие компоненты мы можем взять готовые, а какие придется разработать самим
1. Какая экспертиза нужна для разработки, доработки и интеграции компонентов
1. Иные затраты: лицензии, железо, внешняя экспертиза

_Что это значит конкретно для тебя?_

1. Почти всегда архитектура начнется с решений по структурной декомпозиции.
1. Эти решения очень важны не только и не столько для инженеров, но для таких стейкхолдеров, как Руководитель проекта, Заказчик, Спонсор, Бухгалтерия, Юрист и других ресурсных ролей.
1. Раз эти архитектурные решения по декомпозиции не только для инженеров, то убедись, что твои решения позволяют ресурсным стейкхолдерам понять твои решения и дать по ним обратную связь. Годная структурная декомпозиция – по которой можно прикинуть план работ (диаграмма Ганта) и ресурсный план (BoM).
1. В рамках структурной декомпозиции ты закладываешь возможность брать готовые компоненты системы. 

_Что дальше?_
Задумайся, какие бывают стейкхолдеры в it-разработке? Какие у них интересы?


Справочник ключевых стейкхолдеров
---------------------------------
_Остановись на секунду_ и скажи свое мнение –
какие бывают стейкхолдеры в it-разработке? Какие у них интересы?

Ниже ты познакомишься к ключевыми стейкхолдерами. 
Но помни – это бизнес-_функции_, а значит, что они могут быть сфокусированы в одном сотруднике, или "размазаны" по нескольким, один сотрудник может участвовать в нескольких функциях. То есть сотрудника с таким бейджем может и не быть, но кто-то должен выполнять эту функцию – и часто именно ты как архитектор должен выполнить квест по идентификации нужных сотрудников.
Маркерный вопрос: «Кто у нас отвечает за данный интерес – данный тип решений?»

Таким образом, архитектурные решения – это решения, где ошибки очень дорогие и сложно исправляемые, 
и эти решения нужно принимать вместе с _людьми и группами, отвечающие за_:   

| Стейкхолдер                       | Интерес                                                                                                                                                                                            | Подводные камни                                                                                                                                                                                                                                                                                                                                             |
|-----------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Спонсор, Бухгалтерия              | Выделяет бюджет на целевую систему                                                                                                                                                                 | Зачастую не касается предметных вопросов по целевой системе, единственное, что интересует – финансовые показатели: стоимость, капитализация компании. D продуктовой разработке часто эта функция ложится на Владельца Продукта.                                                                                                                             |
| Заказчик                          | Формулирует ожидания от системы и осуществляет приёмку (acceptance)                                                                                                                                | В заказной разработке: определяет функционал системы и объем работ (functional scope, scope, _скоуп_). Зачастую не является пользователем системы, что добавляет нам шизофрении при общении со Спонсором, Заказчиком и Пользователями. В продуктовой разработке часто представлен Менеджером Продукта.                                                      |
| Юрист, Legal                      | Один из ключевых сервисов. Отвечает за то, чтобы мы всей компанией не присели на нары и не попали на судебные иски.                                                                                | С ним важно согласовывать лицензии программных компонентов и библиотек, которые втаскиваем в проект, и соответствие наших инженерных решений законодательству                                                                                                                                                                                               |
| Пользователь                      | Регулярно использует целевую систему для решения своих задач.                                                                                                                                      | В заказной разработке: важно не только удовлетворить Заказчика, чтобы он принял результат, но и удовлетворить Пользователей. Иногда бывает сложно выровнять скоуп при общении со Спонсором, Заказчиком и Пользователями. В продуктовой разработке часто представлен Менеджером Продукта.                                                                    |
| Владелец продукта, Product Owner  | Успех продукта, достижение бизнес-метрик.                                                                                                                                                          | В продуктовой разработке «продакт» представляет пользователей, бизнес-заказчика. Внутренний предприниматель, который выделяет бюджеты и отвечает за то, что команда реализует правильный функционал. Должен быть носителем продуктовой стратегии, что не всегда происходит.                                                                                 |
| Менеджер проекта, Project Manager | Успех проекта, выполнение нужного scope за выделенный бюджет и время.                                                                                                                              | В заказной разработке мы должны четко выполнить заказ, поэтому «проджект» отвечает за ключевые проектные риски – что мы одинаково c Заказчиком понимаем scope, и что работы идут в соответствии с данным ресурсом времени и бюджета. В продуктовой разработке эта функция часто передается самой команде.                                                   |
| Команда разработки                | Часто (особенно в сервисном и продуктовом подходе) мы выделяем всю команду как единого стейкхолдера, чей интерес – эффективно поставлять ценность для других стейкхолдеров в виде готовой системы. | Сделать из группы сотрудников слаженную команду – долго и дорого. Поэтому эти вложения делаются в основном в сервисном и продуктовом подходе. Для помощи в организации команды появляется Scrum Master / Agile Coach. В проектном подходе чаще эти инвестиции не оправданы.                                                                                 |
| Системный архитектор              | Обеспечивает корректность (соответствие требованиям), внутреннее качество, сроки и бюджет воплощения целевой системы путем принятия ключевых (архитектурных) решений.                              | Системному архитектору нужно своими решениями забороть ключевые проблемы: противоречивость и неполноту требований, неопределенность реализации. Про решения этих фундаментальных проблем поговорим ниже.                                                                                                                                                    |
| Архитектор решения                | Обеспечивает автоматизацию бизнес-функции путем проектирования решения.                                                                                                                            | Задачи и проблемы те же, что и для системной архитектуры, но больше целевой масштаб – это уже не одна целевая система, а несколько. Поэтому требуются несколько иные навыки: большее понимание бизнеса, умение подбирать готовые системы и их интегрировать, формулировать требования к системам, которые не удается взять готовыми и надо их писать самим. |
| Корпоративный архитектор          | Обеспечивает автоматизацию всей компании.                                                                                                                                                          | Задачи и проблемы те же, что и для архитектуры решения, но больше целевой масштаб – это уже весь it-ландшафт компании. Поэтому требуются несколько иные навыки: прекрасное понимание всего бизнеса, умение подбирать связки готовых систем и их интегрировать, оценивать сроки и бюджеты нескольких потоков it-производства.                                |
| Разработчик                       | Воплощает проект системы.                                                                                                                                                                          | В современных реалиях функция разработки чаще всего совмещается с функцией микро-проектирования. Обычно проектирование ассоциируется с большими чертежами и моделями, но это не всегда так – на микро-уровне исходного кода можно вполне проектировать «в уме».                                                                                             |                                                                                                                    |                                                                                                                                                                                                                                                                                                        |
| QA-инженер                        | Обеспечивает внешнее и внутреннее качество целевой системы.                                                                                                                                        | Чтобы обеспечить внешнее (для пользователей) и внутреннее (для команды) качество, QA-инженеру нужно применить целый ряд подходов: ручное и автоматическое тестирование, code review, настройка статических анализаторов кода, и тд.                                                                                                                         |                                                                                                                    |                                                                                                                                                                                                                                                                                                        |
| Инженер по ИБ                     | Обеспечивает информационную безопасность целевой системы.                                                                                                                                          | Безопасность пронизывает все решения по целевой системе, поэтому они должны проходить через согласования с инженером по ИБ.                                                                                                                                                                                                                                 |                                                                                                                    |                                                                                                                                                                                                                                                                                                        |
| DevOps-инженер                    | Обеспечивает нужное время развертывания системы в эксплуатацию, наблюдаемость и доступность после развертывания.                                                                                   | как и для ИБ                                                                                                                                                                                                                                                                                                                                                |                                                                                                                    |                                                                                                                                                                                                                                                                                                        |
| Внешний подрядчик, Service        | Обеспечивает реализацию работ, которые им передали (аутсорс).                                                                                                                                      | Внешнему подрядчику (аутсорсеру) можно передавать необходимые работы, экспертизы в которых нам не хватает или из соображений меньшей стоимости. Но надо помнить, что будет «коммуникационное трение» – аутсорсер не понимает бизнес так же хорошо, у него другая производственная культура и процессы, стандарты.                                           |

_Что это значит конкретно для тебя?_

1. Необходимо знать всех ключевых стейкхолдеров, которые вовлечены в ключевые (архитектурные) решения.
1. Архитектурные решения необходимо с ними согласовывать в терминах, понятных этим стейкхолдерам, в терминах их интересов. Например, РП не интересна диаграмма структурной декомпозиции, но интересен план работ, который следует из неё напрямую.
1. У стейкхолдеров могут разные позиции, должности, роли – но для архитектурных решений неважно, что написано у них на визитке. Важен их интерес – _как_ они влияют на систему, и как она повлияет на них. Выделять стейкхолдеров стоит именно по этому принципу.
1. Функция может быть как выделенная – сконцентрирована в одном сотруднике, так и «размазана» по группе – например, _коллективный архитектор_.
1. Архитектурная функция состоит так же и в том, чтобы выделить и наладить общение со всеми ключевыми стейкхолдерами.

_Что дальше?_
Задумайся, а _какие_ точки зрения обычно получаются при проектировании системы, то есть _про что_ нужно подумать?


Справочник ключевых PoV 
------------------------
_Давай для примера_ представим, что мы проектируем кафе. 
Нам дано помещение в аренду, и в scope проектирования входит все, что внутри.  
Наша задача – в итоге получить успешный бизнес.

_Остановись на секунду_ и скажи свое мнение – _про что_ нужно подумать при проектировании кафе?

Архитектурные решения – это важные решения _про_:

|                                                                        | *Структура поведения системы*. Декомпозиция поведения системы (как мы пакуем, нарезаем поведение по блокам – какие элементы за что отвечают). | *Логика поведения*. Порядок работы, алгоритмы.                                                                                                           | *Структуры данных*. Представление данных в системе.                               | 
|------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|
| *Функциональный уровень*. Что система дает конечному пользователю.     | Меню блюд с разделами. Крейзи-меню.                                                                                                           | Закон о защите прав потребителей. Корпоративная политика работы с клиентом. Скрипты продаж.                                                              | Описания блюд. Структура кассового чека.                                          |
| *Логический уровень*. Модель системы, как её видим при проектировании. | Разбиение на функциональные модули: "ресепшн", "обслуживание столика", "кухня", "уборка" и KPI каждого модуля. Структура менеджмента.         | Описания процессов принятия заказа, готовки блюд (рецепты), заказов продуктов у поставщиков.                                                             | Какими сообщениями обмениваются сотрудники. Описания рецептов. Заказы поставщику. |
| *Физический уровень*. Воплощение системы, как она реально работает.    | План помещений.                                                                                                                               | Нарисованные на полу дорожки для перемещения сотрудников, знаки на дверях и стенах. Распечатанные рабочие инструкции и рецепты. Договоры с поставщиками. | Бланки накладных для поставщиков.                                                 |

Для информационных систем типы решений (точки зрения, PoV) будут очень похожи:

|                                                                         | *Структура поведения*. Декомпозиция поведения системы.                                                                                      | *Логика поведения*. Порядок работы, алгоритмы.                                                                          | *Структуры данных*. Представление данных в системе.                                                                                                                        | 
|-------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| *Функциональный уровень*. Что система дает конечному пользователю.      | _Функциональная декомпозиция_ на модули. Эти решения можно записать как диаграммы UML Use Case, как User Story Epics, функциональную карту. | Потоки данных и алгоритмы предметной области: Data Flow Diagram. UML Sequence, Communication, State, Activity diagrams. | Описание понятий предметной области (domain model): UML Class.                                                                                                             |
| *Логический уровень*. Модель системы - как её видим при проектировании. | _Структурная декомпозиция_ на компоненты: UML Component and Class diagrams.                                                                 | Потоки данных и алгоритмы в нашей системе: UML Sequence, Communication, State, Activity.                                | Структуры данных нашей системы в памяти и в хранилищах: UML Class, ERD.                                                                                                    |
| *Физический уровень*. Воплощение системы - как она реально работает.    | _Развертывание_ c учетом сети и узлов, среды исполнения: UML Deployment diagram.                                                            | Потоки данных и алгоритмы в нашей системе с учетом особенностей ОС, сети и физических узлов: UML Sequence.              | Структуры данных нашей системы в памяти, в хранилищах c учетом их специфики и при передаче по сети: диаграммы UML Class и ERD, специальные языки описания структур данных. |

Помимо этих частых типов решений, так же возникает необходимость принять решения в точках зрения («решить про»):

- Security: обеспечение информационной безопасности в рамках всей системы. 
- Concurrency: обеспечение производительности и корректности данных в многопоточной среде
- Operational: обеспечение наблюдаемости при эксплуатации (мониторинг, журналирование, трейсинг запросов)
- Deployment: обеспечение скорости и корректности самого процесса развертывания, вывода системы в эксплуатацию
- Legal licences: список лицензий на готовые компоненты в нашей системе
- и многих других.

_Что это значит конкретно для тебя?_

1. Целевые системы сложны, их невозможно описать простым образом одной картинкой. Поэтому модель системы мы разбиваем по характеру принимаемых решений и интересам стейкхолдеров на Точки Зрения (Point of View, PoV).
1. При принятии решений и их согласовании нужно всегда понимать, какую точку зрения сейчас обсуждаем.
1. Для каждой точки зрения существует несколько удобных способов записать принятые решения: неструктурированный текст, структурированный текст, подходящая нотация диаграмм. Нужно знать подходящие нотации диаграмм для ключевых типов решений из справочника выше.  
1. Несмотря на большое количество точек зрения, они описывают _единую модель системы_. То есть решения одного типа повлияют на решения другого типа. (Компоненты, на которые нарезали систему при структурной декомпозиции, появятся на диаграмме взаимодействия)  
1. Каждая точка зрения может охватывать _только часть решений_ – самую важную часть. Незначимые решения можно отложить или доверить исполнителю. Тогда их гораздо удобнее читать и они несут больше ценности при обсуждениях.
1. Каждая точка зрения может быть описана несколькими текстами или диаграммами. Каждая диаграмма не обязана описывать _всю_ систему. Тогда их гораздо удобнее читать и они несут больше ценности при обсуждениях.  
1. Решения в каждой точке зрения обычно влияют на характерные свойства целевой системы. Например:

- Решения по структурной декомпозиции (как мы распилим систему на элементы) обычно определяют: насколько систему будет просто понимать, вносить изменения, тестировать; как можно распараллелить разработку; какие компоненты можно взять готовые и какие нужно будет пилить самим; какие компоненты можно будет масштабировать независимо от других.
- Решения по алгоритмам (динамика взаимодействия элементов системы между собой) обычно определяют: производительность, надежность, безопасность, ресурсоемкость, целостность данных.
- и тд. Со временем мы научимся для ключевых типов решений (точек зрения) не просто смотреть на диаграммы, а видеть за ними решения, влияющие на характеристики всей системы – «ставить диагноз по фотографии».

_Что дальше?_
Задумайся, а как тебе для каждого типа решений понять, что принял его верно?
